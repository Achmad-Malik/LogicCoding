<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Hubungkan Huruf</title>
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
  <style>
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      width: 100vw;
      overflow-x: hidden;
    }
    body{
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #1d2b64 0%, #45a247 100%);
      background-size: cover;
      background-attachment: fixed;
      margin:0; text-align:center; color:#fff;
      min-height: 100dvh;
      display:flex; flex-direction:column; align-items:center; justify-content:flex-start;
      box-sizing:border-box; padding:0 0 24px 0;
      width: 100vw;
      overflow-x: hidden;
    }

    @keyframes bg{0%{background-position:0 50%}50%{background-position:100% 50%}100%{background-position:0 50%}}

    h1{
      margin:32px 0 18px 0;
      font-size:1.35em;
      font-weight:700;
      text-shadow:0 0 10px rgba(255,255,255,.7),0 0 18px rgba(0,123,255,.7);
      word-break: break-word;
      max-width: 98vw;
      letter-spacing: 0.5px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }
    h1 .icon-lock {
      font-size: 1.2em;
      margin-right: 4px;
    }

    .info{
      display: flex;
      flex-direction: row;
      justify-content: center;
      align-items: center;
      gap: 18px;
      padding: 8px 18px;
      margin: 0 auto 24px auto;
      border-radius: 14px;
      background:rgba(0,0,0,.22);
      backdrop-filter: blur(5px);
      font-weight:600;
      font-size:1em;
      max-width: 98vw;
      box-sizing: border-box;
      min-height: 38px;
    }
    .info > div {
      min-width: 70px;
      text-align: center;
    }

    .grid{
      display: flex;
      flex-direction: row;
      justify-content: center;
      align-items: center;
      gap: 8px;
      margin: 0 auto 24px auto;
      width: 100%;
      max-width: 340px;
      min-height: 70px;
      box-sizing: border-box;
      flex-wrap: wrap;
    }

    .card{
      width: 44px;
      height: 44px;
      border-radius: 10px;
      border:2px solid #00d4ff;
      background:rgba(255,255,255,.13);
      display:flex;align-items:center;justify-content:center;
      cursor:pointer;user-select:none;
      transition: transform .22s, box-shadow .18s, border-color .18s, background .18s;
      transform-style: preserve-3d;
      box-shadow:0 2px 8px rgba(0,0,0,.13);
      margin: 0;
      position: relative;
    }
    .card:not(:last-child) {
      /* No extra margin, handled by gap */
    }
    .card:hover{ transform: scale(1.06); box-shadow:0 4px 12px rgba(0,0,0,.18)}

    .card .letter{
      font-size: 1.25em;
      font-weight:700;
      color:transparent;
      transform:rotateY(180deg);
      backface-visibility:hidden;
      transition:color .2s ease;
      letter-spacing: 1px;
    }

    .card.revealed{ transform:rotateY(180deg);background:#fff;border-color:#34d399 }
    .card.revealed .letter{ color:#000 }

    .card.matched{
      cursor:default;background:#2d2d2d;border-color:#28a745;
      box-shadow:0 0 10px rgba(40,167,69,.7);animation:pulse .5s ease;
    }
    .card.matched .letter{ color:#fff; }

    @keyframes pulse {
      0%{transform:scale(1)}
      50%{transform:scale(1.07)}
      100%{transform:scale(1)}
    }

    .card.wrong{animation:shake .4s}
    @keyframes shake {
      0%,100%{transform:translateX(0)}
      20%{transform:translateX(-4px)}
      20%{transform:translateX(-6px)}
      40%{transform:translateX(6px)}
      60%{transform:translateX(-6px)}
      80%{transform:translateX(6px)}
    }

    /* ===== Overlay Game Over ala Decode Kata ===== */
    #gameOverOverlay {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0; top: 0; right: 0; bottom: 0;
      width: 100vw; height: 100dvh;
      background: rgba(0,0,0,0.78);
      backdrop-filter: blur(3px);
      align-items: center;
      justify-content: center;
      flex-direction: column;
    }
    #gameOverOverlay.show {
      display: flex;
      animation: popGameOver 0.7s cubic-bezier(.23,1.5,.32,1) both;
    }
    @keyframes popGameOver {
      0% { transform: scale(0.7) translateY(60px); opacity: 0; }
      60% { transform: scale(1.08) translateY(-8px); opacity: 1; }
      80% { transform: scale(.97) translateY(0); }
      100% { transform: scale(1) translateY(0); }
    }

    .skull-emoji {
      font-size: 4.5em;
      animation: skull-pop 1s cubic-bezier(.68,-0.55,.27,1.55);
      filter: drop-shadow(0 0 18px #fff8) drop-shadow(0 0 8px #0008);
    }
    @keyframes skull-pop {
      0% { transform: scale(0.2) rotate(-30deg); opacity: 0; }
      60% { transform: scale(1.2) rotate(10deg); opacity: 1; }
      80% { transform: scale(0.95) rotate(-5deg);}
      100% { transform: scale(1) rotate(0);}
    }
    .skull-text {
      font-size: 2.1em;
      margin: 10px 0;
      font-weight: bold;
      letter-spacing: 1px;
      animation: pulseRed 1.2s infinite alternate;
    }
    @keyframes pulseRed {
      0% { color:#ff3b3b; text-shadow:0 0 18px #ff3b3b,0 0 32px #fff; }
      100% { color:#fff; text-shadow:0 0 32px #ff3b3b,0 0 48px #fff; }
    }

    .gameover-score {
      font-size: 1.3em;
      margin: 12px 0 18px;
      color: #fff;
      text-shadow: 0 0 8px #00d4ff99;
    }

    .gameover-actions-overlay {
      display: flex;
      flex-direction: column;
      gap: 10px;
      align-items: center;
      margin-top: 10px;
      animation: fadein 0.5s;
      width: 100%;
      max-width: 520px; /* diperlebar dari 400px ke 520px */
    }
    @keyframes fadein {
      from { opacity: 0; transform: translateY(20px);}
      to { opacity: 1; transform: translateY(0);}
    }

    /* Perlebar tombol khusus di game over overlay */
    #gameOverOverlay .btn-main, 
    #gameOverOverlay .btn-home {
      width: 50%;
      max-width: 520px; /* diperlebar dari 400px ke 520px */
      min-width: 220px;
      margin: 12px 0 0 0;
      font-size: 1.13em;
      padding: 16px 0; /* diperlebar dari 14px ke 16px */
    }

    .btn-main, .btn-home {
      margin:12px auto 0 auto;
      padding:14px 0; /* diperlebar dari 12px ke 14px */
      font-size:1.08em;
      font-weight:700;
      color:#fff;
      border:none;
      border-radius:22px;
      cursor:pointer;
      box-shadow:0 6px 18px rgba(0,0,0,.28);
      transition: transform .16s, box-shadow .16s, background .18s;
      width:98%; /* diperlebar dari 92% ke 98% */
      max-width:400px; /* diperlebar dari 360px ke 400px */
      display:block;
      letter-spacing:.5px;
    }
    .btn-main { background:linear-gradient(135deg,#007bff,#00d4ff); }
    .btn-main:hover { transform:scale(1.04); background:linear-gradient(135deg,#00bfff,#00eaff); }
    .btn-home { background:linear-gradient(135deg,#28a745,#5be584); }
    .btn-home:hover { transform:scale(1.04); background:linear-gradient(135deg,#34d399,#7cf9a7); }
  </style>
</head>
<body>
  <h1>ðŸ”— Hubungkan Huruf</h1>
  <div class="info">
    <div>Babak: <span id="round">1</span></div>
    <div>Skor: <span id="score">0</span></div>
    <div>High Score: <span id="highScore">0</span></div>
    <div>Kesempatan: <span id="lives">0</span></div>
  </div>

  <div class="grid" id="grid"></div>

  <!-- Overlay Game Over -->
  <div id="gameOverOverlay">
    <span class="skull-emoji">ðŸ’€</span>
    <div class="skull-text">Game Over!</div>
    <div class="gameover-score">
      Skor Akhir: <span id="finalScore">0</span><br>
      High Score: <span id="finalHighScore">0</span>
    </div>
    <div class="gameover-actions-overlay">
      <button class="btn-main" onclick="restartFromStart()">Restart</button>
      <button class="btn-home" onclick="goHome()">Back To Home</button>
    </div>
  </div>

  <button id="btnRestart" class="btn-main" onclick="restartGame()">Ulang Babak</button>
  <button class="btn-home" onclick="goHome()">Back To Home</button>

  <script>
    let score=0;
    let highScore=localStorage.getItem("highScore")||0;
    document.getElementById("highScore").textContent=highScore;

    let selected=[];let matched=[];let round=1;let lives=0;
    let currentLevel="easy";
    const params=new URLSearchParams(window.location.search);
    if(params.get("level")) currentLevel=params.get("level");

    const pointsPerMatch={easy:10,normal:20,hard:30,veryHard:50};
    const livesPerLevel={easy:6,normal:10,hard:13,veryHard:15};

    function shuffle(arr){for(let i=arr.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[arr[i],arr[j]]=[arr[j],arr[i]];}return arr;}

    function startGame(){
      const grid=document.getElementById("grid");
      grid.innerHTML="";
      matched=[];selected=[];
      lives=livesPerLevel[currentLevel];document.getElementById("lives").textContent=lives;
      document.getElementById("round").textContent=round;
      document.getElementById("btnRestart").style.display="inline-block";
      document.getElementById("gameOverOverlay").style.display="none";
      document.getElementById("gameOverOverlay").classList.remove("show");

      let pool=[];
      if(currentLevel==="easy") pool=["A","A","B","B","C","C","D","D"];
      else if(currentLevel==="normal") pool=["A","A","B","B","C","C","D","D","E","E","F","F"];
      else if(currentLevel==="hard") pool=["A","A","B","B","C","C","D","D","E","E","F","F","G","G","H","H"];
      else pool=["A","A","B","B","C","C","D","D","E","E","F","F","G","G","H","H","I","I","J","J"];

      document.querySelector('.grid').style.gridTemplateColumns=pool.length>16?'repeat(5,90px)':'repeat(4,90px)';
      const shuffled=shuffle([...pool]);
      shuffled.forEach((letter,idx)=>{
        const card=document.createElement("div");
        card.className="card";
        card.innerHTML=`<span class="letter">${letter}</span>`;
        card.dataset.letter=letter;card.dataset.index=idx;
        card.addEventListener("click",()=>selectCard(card));
        grid.appendChild(card);
      });
    }

    function selectCard(card){
      if(card.classList.contains("matched")||card.classList.contains("revealed"))return;
      if(lives<=0)return;
      card.classList.add("revealed");
      selected.push(card);
      if(selected.length===2) setTimeout(checkMatch,500);
    }

    function checkMatch(){
      const [c1,c2]=selected;
      if(c1.dataset.letter===c2.dataset.letter && c1.dataset.index!==c2.dataset.index){
        c1.classList.add("matched");c2.classList.add("matched");
        matched.push(c1.dataset.index,c2.dataset.index);
        score+=pointsPerMatch[currentLevel];
        document.getElementById("score").textContent=score;
        if(score>highScore){highScore=score;localStorage.setItem("highScore",highScore);document.getElementById("highScore").textContent=highScore;}
        if(matched.length===document.querySelectorAll(".card").length){round++;startGame();}
      }else{
        lives--;document.getElementById("lives").textContent=lives;
        c1.classList.add("wrong");c2.classList.add("wrong");
        if(lives<=0){gameOver();}
        else{
          setTimeout(()=>{
            c1.classList.remove("revealed","wrong");
            c2.classList.remove("revealed","wrong");
          },400);
        }
      }
      selected=[];
    }

    function gameOver(){
      document.getElementById("grid").innerHTML="";
      document.getElementById("btnRestart").style.display="none";
      const overlay=document.getElementById("gameOverOverlay");
      document.getElementById("finalScore").textContent=score;
      document.getElementById("finalHighScore").textContent=highScore;
      overlay.style.display="flex";
      setTimeout(()=>{ overlay.classList.add("show"); }, 10);
    }
    function restartGame(){
      score=0;
      document.getElementById("score").textContent=score;
      startGame();
    }
    function restartFromStart(){
      score=0;round=1;currentLevel="easy";
      document.getElementById("score").textContent=score;
      startGame();
    }
    function goHome(){window.location.href="index.html";}
    startGame();
  </script>
</body>
</html>
