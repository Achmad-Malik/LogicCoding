<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Hubungkan Huruf</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    html, body { height: 100%; }
    body{
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(-45deg,#1d2b64,#f8cdda,#283c86,#45a247);
      background-size: 400% 400%;
      background-attachment: fixed;
      animation: bg 12s ease infinite;
      margin:0; text-align:center; color:#fff;
      min-height: 100dvh;
      display:flex; flex-direction:column; align-items:center; justify-content:center;
      box-sizing:border-box; padding:18px;
    }
    @keyframes bg{0%{background-position:0 50%}50%{background-position:100% 50%}100%{background-position:0 50%}}

    h1{margin:18px 0 6px;font-size:3em;text-shadow:0 0 15px rgba(255,255,255,.6),0 0 25px rgba(0,123,255,.8);}

    /* Responsive Scoreboard */
    .info{
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 12px 18px;
      padding: 10px 10px;
      margin: 8px auto 0;
      border-radius:14px;
      background:rgba(0,0,0,.3);
      backdrop-filter: blur(5px);
      font-weight:600;
      width: 100%;
      max-width: 520px;
      box-sizing: border-box;
    }
    .info-emoji {
      display: flex;
      align-items: center;
      gap: 4px;
      font-size: 1.08em;
      background: rgba(255,255,255,0.08);
      border-radius: 8px;
      padding: 4px 10px;
      min-width: 90px;
      justify-content: center;
    }
    .info-emoji span.emoji {
      font-size: 1.2em;
      margin-right: 2px;
    }

    @media (max-width: 600px) {
      .info {
        max-width: 98vw;
        gap: 8px 8px;
        padding: 7px 2vw;
        font-size: 0.98em;
      }
      .info-emoji {
        font-size: 0.98em;
        min-width: 70px;
        padding: 3px 6px;
      }
    }
    @media (max-width: 400px) {
      .info {
        flex-direction: column;
        gap: 4px 0;
        padding: 5px 2vw;
        font-size: 0.95em;
      }
      .info-emoji {
        min-width: unset;
        width: 100%;
        justify-content: flex-start;
      }
    }

    .grid{display:grid;grid-template-columns:repeat(4, minmax(48px, 1fr));gap:10px;justify-content:center;margin:14px auto 12px;perspective:900px;width: min(86vw, 520px);} 

    .card{
      width:100%;aspect-ratio:1/1;max-width:72px;border-radius:12px;border:2px solid #00d4ff;
      background:rgba(255,255,255,.14);display:flex;align-items:center;justify-content:center;
      cursor:pointer;user-select:none;transition: transform .32s, box-shadow .28s, border-color .28s, background .28s;
      transform-style: preserve-3d;box-shadow:0 6px 18px rgba(0,0,0,.22);
      margin:0 auto;
    }
    .card:hover{ transform: translateY(-4px); box-shadow:0 10px 24px rgba(0,0,0,.35)}

    .card .letter{
      font-size: clamp(1.4rem, 3.5vw, 2em);font-weight:700;color:transparent;transform:rotateY(180deg);
      backface-visibility:hidden;transition:color .2s ease;
    }

    .card.revealed{ transform:rotateY(180deg);background:#fff;border-color:#34d399 }
    .card.revealed .letter{ color:#000 }

    .card.matched{
      cursor:default;background:#2d2d2d;border-color:#28a745;
      box-shadow:0 0 12px rgba(40,167,69,.8);animation:pulse .5s ease;
    }
    .card.matched .letter{ color:#fff; }

    @keyframes pulse {
      0%{transform:scale(1)}
      50%{transform:scale(1.1)}
      100%{transform:scale(1)}
    }

    .card.wrong{animation:shake .4s}
    @keyframes shake {
      0%,100%{transform:translateX(0)}
      20%{transform:translateX(-6px)}
      40%{transform:translateX(6px)}
      60%{transform:translateX(-6px)}
      80%{transform:translateX(6px)}
    }

    /* Game Over Overlay */
    #gameOverOverlay {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0; top: 0; right: 0; bottom: 0;
      width: 100vw; height: 100dvh;
      background: rgba(0,0,0,0.78);
      backdrop-filter: blur(2.5px);
      align-items: center;
      justify-content: center;
      transition: background 0.4s;
      flex-direction: column;
    }
    #gameOverOverlay.show {
      display: flex;
      animation: overlayFadeIn 0.5s;
    }
    @keyframes overlayFadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    #skull-anim-overlay {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 120px;
      opacity: 1;
      transition: opacity 0.4s;
      margin-bottom: 18px;
      z-index: 1001;
    }
    #skull-anim-overlay.hide {
      opacity: 0;
      pointer-events: none;
      height: 0;
      margin: 0;
      min-height: 0;
    }
    .skull-emoji {
      font-size: 4.5em;
      animation: skull-pop 1s cubic-bezier(.68,-0.55,.27,1.55);
      filter: drop-shadow(0 0 18px #fff8) drop-shadow(0 0 8px #0008);
    }
    @keyframes skull-pop {
      0% { transform: scale(0.2) rotate(-30deg); opacity: 0; }
      60% { transform: scale(1.2) rotate(10deg); opacity: 1; }
      80% { transform: scale(0.95) rotate(-5deg);}
      100% { transform: scale(1) rotate(0);}
    }
    .skull-text {
      font-size: 1.5em;
      margin-top: 8px;
      font-weight: bold;
      letter-spacing: 1px;
      text-shadow: 0 0 8px #fff8, 0 0 12px #0008;
    }
    .gameover-score {
      font-size: 1.3em;
      margin-bottom: 18px;
      color: #fff;
      text-shadow: 0 0 8px #00d4ff99;
    }

    .gameover-actions-overlay {
      display: none;
      flex-direction: column;
      gap: 10px;
      align-items: center;
      margin-top: 10px;
      animation: fadein 0.5s;
      z-index: 1002;
    }
    .gameover-actions-overlay.show {
      display: flex;
    }
    @keyframes fadein {
      from { opacity: 0; transform: translateY(20px);}
      to { opacity: 1; transform: translateY(0);}
    }

    @media (max-width:480px){
      #skull-anim-overlay { min-height: 80px; }
      .skull-emoji { font-size: 3em; }
      #gameOverOverlay {
        padding: 0 0vw;
      }
    }

    button{margin:12px 6px;padding:10px 14px;font-size:1.0em;font-weight:700;color:#fff;border:none;border-radius:20px;cursor:pointer;background:linear-gradient(135deg,#007bff,#00d4ff);box-shadow:0 6px 18px rgba(0,0,0,.28);transition: transform .16s, box-shadow .16s;min-width:140px;min-height:44px}
    button:hover{ transform:scale(1.04); box-shadow:0 8px 20px rgba(0,0,0,.38)}
    .btn-home{ background:linear-gradient(135deg,#28a745,#5be584)}
    
    @media (max-height:700px){
      body{ justify-content:flex-start; padding-top:18px; }
      h1{ margin-top:6px; }
      .grid{ margin-top:8px; }
      .info{ margin-top:6px; }
      button{ padding:10px 14px; font-size:0.96em; }
    }
    @media (max-width:600px){
      button{ width:95%; max-width:450px; min-width:300px; display:block; margin:12px auto }
    }
    @media (max-width:480px){
      .grid{ grid-template-columns: repeat(4, minmax(44px, 1fr)); gap:8px; width:92vw }
      .card{ max-width:72px; border-radius:10px }
      button{ width:95%; max-width:450px; min-width:300px; display:block; margin:12px auto }
      .grid{ gap:8px }
    }

    #btnRestart{ display:block; margin:14px auto; max-width:520px; width:86%; }
    /* Samakan lebar tombol home utama dengan tombol restart */
    #btnHomeMain {
      display: block;
      margin: 14px auto;
      max-width: 520px;
      width: 86%;
    }
    .btn-restart-over {
      display: block;
      margin: 10px auto;
      max-width: 520px;
      width: 86%;
      background: linear-gradient(135deg,#007bff,#00d4ff);
    }
  </style>
</head>
<body>
  <h1>üîó Hubungkan Huruf</h1>
  <div class="info">
    <div class="info-emoji"><span class="emoji">üèÅ</span>Level: <span id="round">1</span></div>
    <div class="info-emoji"><span class="emoji">‚≠ê</span>Score: <span id="score">0</span></div>
    <div class="info-emoji"><span class="emoji">‚ù§Ô∏è</span>Chance: <span id="lives">0</span></div>
    <div class="info-emoji"><span class="emoji">üèÜ</span>High Score: <span id="highScore">0</span></div>
  </div>

  <div class="grid" id="grid"></div>
  <button id="btnRestart" onclick="restartGame()">Restart</button>
  <button class="btn-home" id="btnHomeMain" onclick="goHome()">Back To Home</button>

  <!-- Game Over Overlay -->
  <div id="gameOverOverlay">
    <div id="skull-anim-overlay">
      <span class="skull-emoji">üíÄ</span>
      <div class="skull-text">Game Over!</div>
      <div class="gameover-score">
        Skor Akhir: <span id="finalScore">0</span><br>
        High Score: <span id="finalHighScore">0</span>
      </div>
    </div>
    <div class="gameover-actions-overlay" id="gameoverActionsOverlay">
      <button class="btn-restart-over" onclick="restartFromStart()">Restart</button>
      <button class="btn-home" onclick="goHome()">Back To Home</button>
    </div>
  </div>

  <script>
    let score=0;
    let highScore=localStorage.getItem("highScore")||0;
    document.getElementById("highScore").textContent=highScore;

    let selected=[];let matched=[];let round=1;let lives=0;
    let currentLevel="easy";
    const params=new URLSearchParams(window.location.search);
    if(params.get("level")) currentLevel=params.get("level");

    const pointsPerMatch={easy:10,normal:20,hard:30,veryHard:50};
    const livesPerLevel={easy:5,normal:7,hard:9,veryHard:11};

    function shuffle(arr){for(let i=arr.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[arr[i],arr[j]]=[arr[j],arr[i]];}return arr;}

    function startGame(){
      const grid=document.getElementById("grid");
      grid.innerHTML="";
      hideGameOverOverlay();
      document.getElementById("btnRestart").style.display="inline-block";
      // Tampilkan kembali tombol home utama saat mulai game
      document.getElementById("btnHomeMain").style.display="inline-block";
      matched=[];selected=[];
      lives=livesPerLevel[currentLevel];document.getElementById("lives").textContent=lives;
      document.getElementById("round").textContent=round;

      let pool=[];
      if(currentLevel==="easy") pool=["A","A","B","B","C","C","D","D"];
      else if(currentLevel==="normal") pool=["A","A","B","B","C","C","D","D","E","E","F","F"];
      else if(currentLevel==="hard") pool=["A","A","B","B","C","C","D","D","E","E","F","F","G","G","H","H"];
      else pool=["A","A","B","B","C","C","D","D","E","E","F","F","G","G","H","H","I","I","J","J"];

      document.querySelector('.grid').style.gridTemplateColumns=pool.length>16?'repeat(5,90px)':'repeat(4,90px)';
      const shuffled=shuffle([...pool]);
      shuffled.forEach((letter,idx)=>{
        const card=document.createElement("div");
        card.className="card";
        card.innerHTML=`<span class="letter">${letter}</span>`;
        card.dataset.letter=letter;card.dataset.index=idx;
        card.addEventListener("click",()=>selectCard(card));
        grid.appendChild(card);
      });
    }

    function selectCard(card){
      if(card.classList.contains("matched")||card.classList.contains("revealed"))return;
      if(lives<=0)return;
      card.classList.add("revealed");
      selected.push(card);
      if(selected.length===2) setTimeout(checkMatch,500);
    }

    function checkMatch(){
      const [c1,c2]=selected;
      if(c1.dataset.letter===c2.dataset.letter && c1.dataset.index!==c2.dataset.index){
        c1.classList.add("matched");c2.classList.add("matched");
        matched.push(c1.dataset.index,c2.dataset.index);
        score+=pointsPerMatch[currentLevel];
        document.getElementById("score").textContent=score;
        if(score>highScore){highScore=score;localStorage.setItem("highScore",highScore);document.getElementById("highScore").textContent=highScore;}
        if(matched.length===document.querySelectorAll(".card").length){round++;startGame();}
      }else{
        lives--;document.getElementById("lives").textContent=lives;
        c1.classList.add("wrong");c2.classList.add("wrong");
        if(lives<=0){gameOver();}
        else{
          setTimeout(()=>{
            c1.classList.remove("revealed","wrong");
            c2.classList.remove("revealed","wrong");
          },400);
        }
      }
      selected=[];
    }

    function gameOver(){
      document.getElementById("grid").innerHTML="";
      document.getElementById("btnRestart").style.display="none";
      // Sembunyikan tombol home utama saat game over
      document.getElementById("btnHomeMain").style.display="none";
      showGameOverOverlay();
    }

    function showGameOverOverlay() {
      const overlay = document.getElementById("gameOverOverlay");
      const skullAnim = document.getElementById("skull-anim-overlay");
      const actions = document.getElementById("gameoverActionsOverlay");
      overlay.classList.add("show");
      skullAnim.classList.remove("hide");
      actions.classList.remove("show");
      // Tampilkan tengkorak, lalu tombol setelah delay
      setTimeout(()=>{
        skullAnim.classList.remove("hide"); // tetap tampil
        actions.classList.add("show");
      }, 1200);
    }
    function hideGameOverOverlay() {
      const overlay = document.getElementById("gameOverOverlay");
      const skullAnim = document.getElementById("skull-anim-overlay");
      const actions = document.getElementById("gameoverActionsOverlay");
      overlay.classList.remove("show");
      skullAnim.classList.remove("hide");
      actions.classList.remove("show");
    }

    function restartGame(){
      score=0;
      document.getElementById("score").textContent=score;
      startGame();
    }
    function restartFromStart(){
      score=0;round=1;currentLevel="easy";
      document.getElementById("score").textContent=score;
      startGame();
    }
    function goHome(){window.location.href="index.html";}
    startGame();
  </script>
</body>
</html>
